# Retro Notes (Living Document)

*Agents: add notes here AS THINGS HAPPEN during the sprint. Don't wait for the retro.*
*Format: `- [agent] observation or concern (context)`*
*Clear after each retrospective.*

## Current Sprint Notes

- [xp-coach] Sprint 11 kickoff: 3 agents in_progress (devops on build baseline, qa-lead on gameplay tests, engine-architect on wave investigation). Retro notes empty — will nudge agents to document observations as they work. (Sprint start)
- [devops] Baseline build: Game 19.9s, Editor 7.7s, 183/183 tests pass. Clean start. Build was incremental (only 2 actions for Editor) -- fast feedback loop when no source changes. (Task #1)
- [engine] Wave logic code review: TryFillHomeSlot -> OnWaveComplete -> OnRoundCompleteFinished chain looks correct. HomeSlotsFilledCount accumulates across fills and only resets in ResetHomeSlots() (called from OnRoundCompleteFinished, ReturnToTitle, StartGame). No code-level bug found. Suspect Sprint 9 QA issue is either: (a) PlayUnreal automation timing — sending hops during Spawning state causes HandleHopCompleted to reject them, or (b) frog dying before reaching all 5 slots. Need live game reproduction to confirm. (Task #10 investigation)
- [qa-lead] Scenario 3 (river platform survive) is the most valuable test in GameplayTest.cpp — it exercises FindPlatformAtCurrentPosition via TActorIterator in a real UWorld, which is the exact code path that broke in Sprint 10. Scenarios 2 and 6 use manual HandleHazardOverlap because physics overlap events don't fire in our minimal test world. (Task #9 design)
- [qa-lead] Scenario 5 (wave increment) uses NewObject GameMode (no UWorld) like SeamTest.cpp — TryFillHomeSlot/OnWaveComplete/OnRoundCompleteFinished don't need TActorIterator. Keeps test fast and focused on state machine. (Task #9 design)
- [engine] VFX investigation pre-read (Task #8): SpawnVFXActor correctly sets RootComponent before RegisterComponent (Sprint 9 fix). Spatial tests confirm position is correct. FlatColorMaterial runtime creation uses WITH_EDITORONLY_DATA + PreEditChange/PostEditChange for shader compilation. The frog (same material pipeline) IS visible, so the material itself works. Hypotheses: (a) VFX actors spawn but get Destroy()'d too quickly by TickVFX, (b) actors spawn at wrong Z or behind camera, (c) material instance isn't persisting. Need live game with PlayUnreal screenshots to narrow down.
- [qa-lead] Pre-wrote FindPlatform boundary tests (Task #4) while waiting for Task #3 UPROPERTY. 10 tests total: 4 FOUND cases (center, 25% interior, just-inside, negative-side) + 6 NOT FOUND cases (just-outside, raw-edge, wrong-row, non-rideable, two-platforms, submerged). All read PlatformLandingMargin from frog at runtime. This pattern — writing tests against a planned API before the implementation lands — saved a full write+build cycle. (Task #4 pre-write)
- [xp-coach] Mid-sprint check: 3 of 11 tasks completed, 4 in_progress. Critical path is Task #2 (GetGameConfigJSON) — blocks Tasks 3, 5. QA pre-wrote Task #4 tests against planned API — good parallel work pattern worth codifying. No Section 19 conflicts observed. (Mid-sprint)
- [devops] UBT mutex contention: 3 failed build attempts over ~4 min. ConflictingInstance while engine-architect builds. My changes are comment-only (SYNC annotations) so the in-flight build includes them. Section 19 covers test runs but not UBT builds — should it? (Task #11 blocked)
- [devops] Python constant sync refactor: debug_navigation.py went from 7 hardcoded constants to zero by using `import path_planner` and qualified references (path_planner.CELL_SIZE). test_crossing.py same pattern. Key Python gotcha: `from path_planner import CELL_SIZE` creates a NEW binding that won't update when path_planner.init_from_config() runs. Always use `path_planner.CELL_SIZE` when the value may change at runtime. (Task #5)
- [devops] Multi-agent file ownership conflict: All 4 of my completed edits (run-tests.sh filters, SYNC annotations on C++/Python, client.py get_config, path_planner init_from_config) were overwritten by other agents editing the same files. Had to re-apply everything. Section 19 lock file only protects test runs, not file edits. Need stronger file ownership enforcement or git-based conflict detection. (Post-context-compaction recovery)
- [devops] ChaosSolverEngine assertion crash: After clean rebuild, `Assertion failed: FoundPackage [UObjectGlobals.cpp:6705] Code not found for generated code (package /Script/ChaosSolverEngine)` — uproject has ChaosSolverPlugin disabled but engine still loads ChaosSolverEngine package. Second clean build resolved it. Intermittent issue — likely stale intermediate files from concurrent builds. (Build investigation)
- [devops] BSD sed gotcha: `\s` is not supported in BSD sed (macOS). --check-sync silently failed because `sed -n "s/.*${var}\s*=.../p"` matched nothing. Fixed with POSIX `[[:space:]]` in grep and literal spaces in sed. (Task #11 fix)
- [devops] Final verification: 202/202 tests pass (19 new this sprint). New categories: Collision 25, Gameplay 6, GameConfig 3. All 5 SYNC constants verified matching. (Sprint end)
- [xp-coach] DevOps reports all tasks complete (1, 5, 7, 11). Two process issues to address in retro: (1) Multi-agent file ownership conflict (line 19) — edits overwritten by concurrent agents editing same files. Section 1 "one writer per file" was violated. Need enforcement mechanism beyond convention. (2) UBT mutex contention (line 17) — Section 19 covers test runs but not builds. Should extend lock file to cover UBT builds too. Both are infrastructure gaps, not discipline failures. (Late-sprint process review)
- [xp-coach] Positive pattern to codify: QA pre-wrote tests against planned API (line 15). DevOps used `path_planner.CONSTANT` qualified references instead of `from X import Y` to preserve runtime mutability (line 18). Both are reusable conventions. (Patterns for retro)
